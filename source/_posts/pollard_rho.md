---
layout: post
date: 2018-8-24
title: "Pollard_Rho分解质因数"
categories: [OI, 数学, Pollard_Rho分解质因数]
tags: [讲稿, 数学, Pollard_Rho分解质因数]
mathjax: true
---

Pollard_Rho的核心思想大概是两个:

1. 生日攻击理论

2. 假设当前要分解的数$p=a*b$，$a$和$b$很稀有，但是$a$和$b$的倍数却有很多，所以只要找到一个数$c$，使得$gcd(c,p)>1$即可

<!-- more -->

所以算法大概是这样：

1. 在[2,n-1]之间随机一些数$x_1,x_2...x_k$,$k$大概是$n^{\frac{1}{4}}$级别

2. 判断是否存在$gcd(\mid x_i-x_j\mid ,p)>1$

但把这些x全部预处理出来的方法太傻了，事实上我们可以先造两个数出来，然后不断地生成伪随机数，pollard告诉我们,$x_{i+1}=(x_i^2+a)%N$是一个非常好的随机函数，这里的$a$是随机的，通常随机一个不会出锅~~如果真的出锅了就再随机一个~~

不过这个随机算法有一点问题：这样随机下去之后，$x_i$会重复。如果把所有的$x_i$都存下来然后哈希显然又显得烦了一些，有两种判圈算法可以帮我们在发现入圈之后跳出去

1. Floyd判圈法：它的核心思想是这样的：假设乌龟和兔子在某种形状的跑道上跑，兔子的速度比乌龟快，那么除了在起点的时刻，如果兔子遇到了乌龟，说明跑道上存在环，套用在pollard_rho上，就是$x_{i+1}=(x_i^2+a)%N$这个函数，准备$x$和$y$两个变量，一个每次做一下，一个每次做两下，模拟乌龟和兔子

2. Brent判圈法：还是用乌龟和兔子举例子，乌龟不动，兔子每跑一步，就判断一下是否和兔子相遇，一旦兔子跑的步数是2的次幂，就把乌龟移到兔子的位置。这个算法比Floyd要好一些
